(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{197:function(e,t,s){"use strict";s.r(t);var a=s(0),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#main-requirements"}},[e._v("Main Requirements")])]),s("li",[s("a",{attrs:{href:"#caveats"}},[e._v("Caveats")])]),s("li",[s("a",{attrs:{href:"#options-needed"}},[e._v("Options Needed")])]),s("li",[s("a",{attrs:{href:"#control-message-details"}},[e._v("Control Message Details")]),s("ul",[s("li",[s("a",{attrs:{href:"#global-control"}},[e._v('"Global" Control')])]),s("li",[s("a",{attrs:{href:"#topic-control"}},[e._v("Topic Control")])]),s("li",[s("a",{attrs:{href:"#client-or-user-control"}},[e._v("Client or User Control")])])])]),s("li",[s("a",{attrs:{href:"#other-ideas"}},[e._v("Other ideas")])])])]),s("p"),e._v(" "),s("h2",{attrs:{id:"main-requirements"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#main-requirements"}},[e._v("#")]),e._v(" Main Requirements")]),e._v(" "),s("ul",[s("li",[e._v("Use Node-RED's native Context Storage feature")]),e._v(" "),s("li",[e._v("Integrate with uibuilder's cache control messages")]),e._v(" "),s("li",[e._v("Control (clear or replay) the cache using a control input message")]),e._v(" "),s("li",[e._v("Control the cache by topic or client/user id")]),e._v(" "),s("li",[e._v("Control the overall size of the cache by restricting the maximum number of messages (by topic/client/user)")]),e._v(" "),s("li",[e._v("Allow replay of a specific position in the cache")]),e._v(" "),s("li",[e._v("Multi-instance - use as many infocash nodes as memory allows, uses node context so all data is isolated.")]),e._v(" "),s("li",[e._v('Identify clients by a specified message property (defaults to "_socketId" to work with uibuilder)')]),e._v(" "),s("li",[e._v("Take any uibuilder control message. Only respond to cache control messages. No further flow logic required.")]),e._v(" "),s("li",[e._v("uibuilder control messages will not be cached.")]),e._v(" "),s("li",[e._v("Slight delay (250ms) on replay along with a deduplication of requests (debounce)\nto handle the fact that front-ends need to send a trigger on window.load AND on socket connected.")]),e._v(" "),s("li",[e._v("Allow reverse replay. Default is first-in-first out (FIFO) but should be able to replay as LIFO (last in, first out).")]),e._v(" "),s("li",[e._v("Allow replay of first, last or specific index position only.")]),e._v(" "),s("li",[e._v("Update status on new entry, visual warning if nearly full or full.")])]),e._v(" "),s("h2",{attrs:{id:"caveats"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#caveats"}},[e._v("#")]),e._v(" Caveats")]),e._v(" "),s("ul",[s("li",[e._v("Replayed messages are NOT exact copies of the original message. Only key data is saved in the cache. The msg.payload and topic/_socketId/user-id (as needed).\n"),s("ul",[s("li",[e._v("Maybe other properties can be saved in the future but this is complex if we want to avoid costly cloning.")])])])]),e._v(" "),s("h2",{attrs:{id:"options-needed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#options-needed"}},[e._v("#")]),e._v(" Options Needed")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("Cache Data by:")]),e._v(" "),s("ul",[s("li",[e._v("any message (no categorisation, flat record of input messages)")]),e._v(" "),s("li",[e._v("topic (a queue of input messages per topic)")]),e._v(" "),s("li",[e._v("user (a queue of input messages per client or user id)")]),e._v(" "),s("li",[e._v("both topic and user")])])]),e._v(" "),s("li",[s("p",[e._v("Number of entries")])])]),e._v(" "),s("h2",{attrs:{id:"control-message-details"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#control-message-details"}},[e._v("#")]),e._v(" Control Message Details")]),e._v(" "),s("p",[e._v("These come from the design of uibuilder but can be used by any node or created yourself.")]),e._v(" "),s("h3",{attrs:{id:"global-control"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#global-control"}},[e._v("#")]),e._v(' "Global" Control')]),e._v(" "),s("p",[e._v("Controls the whole cache.")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("Cache Replay")]),e._v(" "),s("p",[e._v("Example msg (example from a client reloading the page):")]),e._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"uibuilderCtrl"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"ready for content"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"cacheControl"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"REPLAY"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"from"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"client"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"_socketId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"/nr/uib#Bxtu968meXIZhcpSAAAH"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"_uibAuth"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"topic"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"uib1Topic"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"_msgid"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"70d3a693.1b7348"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br")])])]),e._v(" "),s("li",[s("p",[e._v("Cache Clear")])])]),e._v(" "),s("h3",{attrs:{id:"topic-control"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#topic-control"}},[e._v("#")]),e._v(" Topic Control")]),e._v(" "),s("p",[e._v("Controls a single topic in the cache.")]),e._v(" "),s("h3",{attrs:{id:"client-or-user-control"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#client-or-user-control"}},[e._v("#")]),e._v(" Client or User Control")]),e._v(" "),s("p",[e._v("Controls the cache for a single client or user")]),e._v(" "),s("h2",{attrs:{id:"other-ideas"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#other-ideas"}},[e._v("#")]),e._v(" Other ideas")]),e._v(" "),s("ul",[s("li",[e._v("Record timestamp with msg?")]),e._v(" "),s("li",[e._v("Allow replay in reverse order?")]),e._v(" "),s("li",[e._v("Button to manually clear the cache (possibly several buttons to clear the full cache or a topic/client/user)?")]),e._v(" "),s("li",[e._v("Option to auto-clear if store or variable name is changed?")]),e._v(" "),s("li",[e._v("Maybe add cache-control:NEW to allow sending only of cached messages since the last cache-control:REPLAY or NEW.")]),e._v(" "),s("li",[e._v("Allow the replay delay time to be changed in the admin ui")]),e._v(" "),s("li",[e._v("Cache messages for a maximum time (in seconds)")]),e._v(" "),s("li",[e._v("Reset after replay if desired")])])])}),[],!1,null,null,null);t.default=r.exports}}]);