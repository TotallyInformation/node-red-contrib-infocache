<!--
    Copyright (c) 2019 Julian Knight (Totally Information)

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

<script type="text/javascript">
// Isolate this code
;(function () {
    'use strict'

    /** @typedef {import("node-red").Red} Red */

    //#region --------- "global" variables for the panel --------- //

    /** Module name must match this nodes html file @constant {string} moduleName */
    var moduleName  = 'infocache'
    /** Node's label @constant {string} paletteCategory */
    var nodeLabel  = 'info cache'
    /** Node's palette category @constant {string} paletteCategory */
    var paletteCategory  = 'uibuilder'
    /** Node's background color @constant {string} paletteColor */
    var paletteColor  = '#E6E0F8'
    /** Node's icon image */
    var nodeIcon = 'db.png'

    //#endregion ------------------------------------------------- //

    // Register the node type, defaults and set up the edit fns 
     //@ts-ignore 
    RED.nodes.registerType(moduleName, {
        /** @see https://nodered.org/docs/creating-nodes/node-html */
        category: paletteCategory,
        color: paletteColor,
        defaults: {
            name: { value: '' },
            topic: { value: '' },
        },
        inputs: 1,
        outputs: 1,
        /** @see https://nodered.org/docs/creating-nodes/appearance#icon, @see https://fontawesome.com/v4.7.0/icons/ */
        icon: nodeIcon, //'font-awesome/fa-random',
        //paletteLabel: nodeLabel,
        label: function () { return this.url || this.name || nodeLabel },

        /** Prepares the Editor panel */
        oneditprepare: function () {
            var that = this

            //console.log('RED', RED)
            console.log('[infocache:oneditprepare] THIS', that)

        }, // ---- End of oneditprepare ---- //

        /** Runs before save */
        // oneditsave: function() {
        // }, // ---- End of oneditsave ---- //

        /** Runs before cancel */
        // oneditcancel: function() {
        // }, // ---- End of oneditcancel ---- //

        /** Handle window resizing for the editor */
        // oneditresize: function(_size) {
        // }, // ---- End of oneditcancel ---- //

    }) // ---- End of registerType() ---- //
})()
</script>

<script type="text/x-red" data-template-name="infocache">
    <div id="main-props">
        <div class="form-row">
            <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
            <input type="text" id="node-input-name">
        </div>

        <div class="form-row" title="Adds a msg.topic to input msgs if not already provided">
            <label for="node-input-topic"><i class="fa fa-tasks"></i> Topic</label>
            <input type="text" id="node-input-topic">
        </div>

    </div>

</script>

<script type="text/x-red" data-help-name="infocache">
<div>HELP!</div>
</script>
